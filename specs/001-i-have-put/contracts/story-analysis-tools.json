{
  "mcp_tools": {
    "analyze_story_structure": {
      "description": "Analyze story structure and identify three-act progression with genre-specific variations",
      "parameters": {
        "type": "object",
        "properties": {
          "story_content": {
            "type": "string",
            "description": "The story outline or content to analyze"
          },
          "genre": {
            "type": "string", 
            "description": "Primary genre classification",
            "enum": ["thriller", "drama", "comedy", "action", "horror", "romance", "sci-fi", "fantasy", "mystery", "western", "war", "historical", "biographical", "documentary", "animation"]
          },
          "project_id": {
            "type": "string",
            "description": "Unique project identifier for process isolation"
          }
        },
        "required": ["story_content", "project_id"]
      },
      "returns": {
        "type": "object",
        "properties": {
          "arc_analysis": {
            "type": "object",
            "properties": {
              "act_structure": {
                "type": "object",
                "properties": {
                  "act_one": {
                    "type": "object", 
                    "properties": {
                      "start_position": {"type": "number"},
                      "end_position": {"type": "number"},
                      "purpose": {"type": "string"},
                      "key_events": {"type": "array", "items": {"type": "string"}}
                    }
                  },
                  "act_two": {"type": "object"},
                  "act_three": {"type": "object"},
                  "turning_points": {"type": "array"},
                  "confidence_score": {"type": "number", "minimum": 0, "maximum": 1}
                }
              },
              "genre_compliance": {
                "type": "object",
                "properties": {
                  "authenticity_score": {"type": "number", "minimum": 0, "maximum": 1},
                  "meets_threshold": {"type": "boolean", "description": "true if >= 75% confidence"},
                  "conventions_met": {"type": "array", "items": {"type": "string"}},
                  "conventions_missing": {"type": "array", "items": {"type": "string"}},
                  "recommendations": {"type": "array", "items": {"type": "string"}}
                }
              },
              "pacing_analysis": {
                "type": "object",
                "properties": {
                  "tension_curve": {"type": "array", "items": {"type": "number"}},
                  "pacing_issues": {"type": "array", "items": {"type": "string"}},
                  "suggested_improvements": {"type": "array", "items": {"type": "string"}},
                  "confidence_score": {"type": "number", "minimum": 0, "maximum": 1}
                }
              },
              "content_warnings": {
                "type": "array",
                "items": {
                  "type": "object",
                  "properties": {
                    "warning_type": {"type": "string"},
                    "description": {"type": "string"},
                    "confidence_impact": {"type": "number"}
                  }
                }
              }
            }
          }
        }
      }
    },

    "track_plot_threads": {
      "description": "Track plot threads across multiple episodes and identify lifecycle status",
      "parameters": {
        "type": "object",
        "properties": {
          "project_id": {
            "type": "string",
            "description": "Project identifier for process isolation"
          },
          "threads": {
            "type": "array",
            "items": {
              "type": "object", 
              "properties": {
                "id": {"type": "string"},
                "name": {"type": "string"},
                "type": {"type": "string", "enum": ["main", "subplot", "character_arc", "mystery", "romance", "conflict"]},
                "episodes": {"type": "array", "items": {"type": "integer"}},
                "current_stage": {"type": "string", "enum": ["introduced", "developing", "ready_for_resolution", "resolved", "abandoned"]}
              },
              "required": ["name", "type", "episodes"]
            }
          },
          "episode_range": {
            "type": "object",
            "properties": {
              "start": {"type": "integer"},
              "end": {"type": "integer"}
            }
          }
        },
        "required": ["project_id", "threads"]
      },
      "returns": {
        "type": "object",
        "properties": {
          "thread_analysis": {
            "type": "array",
            "items": {
              "type": "object",
              "properties": {
                "thread_id": {"type": "string"},
                "lifecycle_stage": {"type": "string"},
                "confidence_score": {"type": "number", "minimum": 0, "maximum": 1},
                "resolution_opportunities": {"type": "array", "items": {"type": "string"}},
                "dependencies": {"type": "array", "items": {"type": "string"}},
                "importance_score": {"type": "number"},
                "suggested_actions": {"type": "array", "items": {"type": "string"}}
              }
            }
          },
          "overall_assessment": {
            "type": "object",
            "properties": {
              "total_threads": {"type": "integer"},
              "unresolved_threads": {"type": "integer"},
              "abandoned_threads": {"type": "integer"},
              "narrative_cohesion_score": {"type": "number"},
              "confidence_score": {"type": "number", "minimum": 0, "maximum": 1}
            }
          }
        }
      }
    },

    "validate_consistency": {
      "description": "Validate narrative consistency and detect plot holes, timeline issues, character contradictions",
      "parameters": {
        "type": "object",
        "properties": {
          "project_id": {
            "type": "string",
            "description": "Project identifier for process isolation"
          },
          "story_elements": {
            "type": "object",
            "properties": {
              "characters": {"type": "array", "items": {"type": "object"}},
              "events": {"type": "array", "items": {"type": "object"}},
              "world_details": {"type": "array", "items": {"type": "object"}},
              "timeline": {"type": "array", "items": {"type": "object"}}
            }
          },
          "validation_scope": {
            "type": "array",
            "items": {"type": "string", "enum": ["timeline", "character", "world", "plot", "continuity"]},
            "description": "Types of consistency to validate"
          }
        },
        "required": ["project_id", "story_elements"]
      },
      "returns": {
        "type": "object",
        "properties": {
          "consistency_report": {
            "type": "object",
            "properties": {
              "overall_score": {"type": "number", "minimum": 0, "maximum": 1},
              "confidence_score": {"type": "number", "minimum": 0, "maximum": 1},
              "issues": {
                "type": "array",
                "items": {
                  "type": "object",
                  "properties": {
                    "type": {"type": "string"},
                    "severity": {"type": "string", "enum": ["critical", "warning", "suggestion"]},
                    "description": {"type": "string"},
                    "location": {"type": "string"},
                    "suggested_fix": {"type": "string"},
                    "confidence_impact": {"type": "number"}
                  }
                }
              },
              "strengths": {"type": "array", "items": {"type": "string"}},
              "recommendations": {"type": "array", "items": {"type": "string"}}
            }
          }
        }
      }
    },

    "apply_genre_patterns": {
      "description": "Apply genre-specific storytelling conventions and provide authenticity recommendations",
      "parameters": {
        "type": "object",
        "properties": {
          "project_id": {
            "type": "string",
            "description": "Project identifier for process isolation"
          },
          "genre": {
            "type": "string",
            "description": "Target genre for pattern application",
            "enum": ["thriller", "drama", "comedy", "action", "horror", "romance", "sci-fi", "fantasy", "mystery", "western", "war", "historical", "biographical", "documentary", "animation"]
          },
          "story_beats": {
            "type": "array",
            "items": {
              "type": "object",
              "properties": {
                "position": {"type": "number"},
                "type": {"type": "string"},
                "description": {"type": "string"}
              }
            }
          },
          "character_types": {
            "type": "array",
            "items": {
              "type": "object",
              "properties": {
                "name": {"type": "string"},
                "role": {"type": "string"},
                "archetype": {"type": "string"}
              }
            }
          }
        },
        "required": ["project_id", "genre"]
      },
      "returns": {
        "type": "object",
        "properties": {
          "genre_guidance": {
            "type": "object",
            "properties": {
              "convention_compliance": {
                "type": "object",
                "properties": {
                  "score": {"type": "number"},
                  "meets_threshold": {"type": "boolean", "description": "true if >= 75% confidence"},
                  "confidence_score": {"type": "number", "minimum": 0, "maximum": 1},
                  "met_conventions": {"type": "array", "items": {"type": "string"}},
                  "missing_conventions": {"type": "array", "items": {"type": "string"}}
                }
              },
              "authenticity_improvements": {
                "type": "array",
                "items": {
                  "type": "object",
                  "properties": {
                    "aspect": {"type": "string"},
                    "current_state": {"type": "string"},
                    "recommendation": {"type": "string"},
                    "impact": {"type": "string", "enum": ["high", "medium", "low"]},
                    "confidence": {"type": "number", "minimum": 0, "maximum": 1}
                  }
                }
              },
              "genre_specific_beats": {
                "type": "array",
                "items": {
                  "type": "object",
                  "properties": {
                    "beat_type": {"type": "string"},
                    "suggested_position": {"type": "number"},
                    "purpose": {"type": "string"},
                    "examples": {"type": "array", "items": {"type": "string"}},
                    "confidence": {"type": "number", "minimum": 0, "maximum": 1}
                  }
                }
              }
            }
          }
        }
      }
    },

    "get_story_session": {
      "description": "Retrieve or create story analysis session for project continuity until completion",
      "parameters": {
        "type": "object",
        "properties": {
          "project_id": {
            "type": "string",
            "description": "Project identifier for process isolation"
          }
        },
        "required": ["project_id"]
      },
      "returns": {
        "type": "object",
        "properties": {
          "session": {
            "type": "object",
            "properties": {
              "session_id": {"type": "string"},
              "project_id": {"type": "string"},
              "active_story_arcs": {"type": "array", "items": {"type": "string"}},
              "last_activity": {"type": "string"},
              "session_status": {"type": "string", "enum": ["active", "suspended", "expired"]},
              "process_isolation_active": {"type": "boolean"},
              "persistence_policy": {"type": "string", "enum": ["until_completion", "manual_deletion"]}
            }
          }
        }
      }
    },

    "calculate_pacing": {
      "description": "Calculate story pacing and tension curves to identify pacing issues", 
      "parameters": {
        "type": "object",
        "properties": {
          "project_id": {
            "type": "string",
            "description": "Project identifier for process isolation"
          },
          "narrative_beats": {
            "type": "array",
            "items": {
              "type": "object",
              "properties": {
                "position": {"type": "number"},
                "type": {"type": "string"},
                "emotional_impact": {"type": "number"},
                "tension_level": {"type": "number"}
              }
            }
          },
          "target_genre": {
            "type": "string",
            "description": "Genre for pacing comparison",
            "enum": ["thriller", "drama", "comedy", "action", "horror", "romance", "sci-fi", "fantasy", "mystery", "western", "war", "historical", "biographical", "documentary", "animation"]
          }
        },
        "required": ["project_id", "narrative_beats"]
      },
      "returns": {
        "type": "object", 
        "properties": {
          "pacing_analysis": {
            "type": "object",
            "properties": {
              "tension_curve": {"type": "array", "items": {"type": "number"}},
              "pacing_score": {"type": "number"},
              "confidence_score": {"type": "number", "minimum": 0, "maximum": 1},
              "rhythm_analysis": {
                "type": "object",
                "properties": {
                  "fast_sections": {"type": "array"},
                  "slow_sections": {"type": "array"},
                  "balanced_sections": {"type": "array"}
                }
              },
              "recommendations": {"type": "array", "items": {"type": "string"}},
              "genre_compliance": {"type": "number", "minimum": 0, "maximum": 1}
            }
          }
        }
      }
    }
  },

  "protocol_version": "2024-11-05",
  "service_info": {
    "name": "mcp-story-service",
    "version": "1.0.0",
    "description": "Narrative intelligence MCP server for AI movie production with process isolation and 75% confidence thresholds",
    "tools_count": 6,
    "features": [
      "Process isolation per project",
      "75% confidence threshold for recommendations", 
      "Partial analysis for malformed content",
      "Session persistence until project completion",
      "15+ genre template support",
      "Fail-fast external service integration"
    ]
  }
}